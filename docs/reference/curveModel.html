<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Curve Model Structure — curveModel • SGAT</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">SGAT</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Curve Model Structure</h1>
    </div>

    
    <p>Light Curve Model Structures for Stella and Estelle</p>
    

    <pre class="usage"><span class='fu'>curveModel</span>(<span class='no'>time</span>, <span class='no'>light</span>, <span class='no'>segment</span>, <span class='no'>calibration</span>, <span class='no'>alpha</span>, <span class='no'>beta</span>,
  <span class='kw'>logp.x</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>rep.int</span>(<span class='fl'>0L</span>, <span class='fu'>nrow</span>(<span class='no'>x</span>)), <span class='kw'>logp.z</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>z</span>)
  <span class='fu'>rep.int</span>(<span class='fl'>0L</span>, <span class='fu'>nrow</span>(<span class='no'>z</span>)), <span class='kw'>x0</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>z0</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>fixedx</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>dt</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>curveModel0</span>(<span class='no'>time</span>, <span class='no'>light</span>, <span class='no'>segment</span>, <span class='no'>calibration</span>, <span class='no'>alpha</span>, <span class='kw'>logp.x</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>)
  <span class='fu'>rep.int</span>(<span class='fl'>0L</span>, <span class='fu'>nrow</span>(<span class='no'>x</span>)), <span class='kw'>logp.z</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>z</span>) <span class='fu'>rep.int</span>(<span class='fl'>0L</span>, <span class='fu'>nrow</span>(<span class='no'>z</span>)),
  <span class='kw'>fixedx</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>time</th>
      <td><p>vector of sample times as POSIXct.</p></td>
    </tr>
    <tr>
      <th>light</th>
      <td><p>vector of observed (log) light levels.</p></td>
    </tr>
    <tr>
      <th>segment</th>
      <td><p>vector of integers that assign observations to
twilight segments.</p></td>
    </tr>
    <tr>
      <th>calibration</th>
      <td><p>function that maps zenith angles to expected
light levels.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>parameters of the twilight model.</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>parameters of the behavioural model.</p></td>
    </tr>
    <tr>
      <th>logp.x</th>
      <td><p>function to evaluate any additional contribution to
the log posterior from the twilight locations.</p></td>
    </tr>
    <tr>
      <th>logp.z</th>
      <td><p>function to evaluate any additional contribution to
the log posterior from the intermediate locations.</p></td>
    </tr>
    <tr>
      <th>x0</th>
      <td><p>suggested starting points for twilight locations.</p></td>
    </tr>
    <tr>
      <th>z0</th>
      <td><p>suggested starting points for intermediate locations.</p></td>
    </tr>
    <tr>
      <th>fixedx</th>
      <td><p>logical vector indicating which twilight locations
to hold fixed.</p></td>
    </tr>
    <tr>
      <th>dt</th>
      <td><p>time intervals for speed calculation in hours.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with components</p>
<dt><code>logpx</code></dt><dd><p>function to evaluate the contributions to the
log posterior from the twilight model</p></dd>
<dt><code>logpz</code></dt><dd><p>function to evaluate the contributions to the
log posterior from the prior for the z locations</p></dd>
<dt><code>estelle.logpb</code></dt><dd><p>function to evaluate contribution to
the log posterior from the behavioural model for estelle.</p></dd>
<dt><code>stella.logpb</code></dt><dd><p>function to evaluate contribution to
the log posterior from the behavioural model for stella.</p></dd>
<dt><code>fitted</code></dt><dd><p>function to evaluate the fitted values for a
given set of locations.</p></dd>
<dt><code>fixedx</code></dt><dd><p>a logical vector indicating which locations
should remain fixed.</p></dd>
<dt><code>x0</code></dt><dd><p>an array of initial twilight locations.</p></dd>
<dt><code>z0</code></dt><dd><p>an array of initial intermediate locations.</p></dd>
<dt><code>time</code></dt><dd><p>the sample times.</p></dd>
<dt><code>light</code></dt><dd><p>the recorded light levels.</p></dd>
<dt><code>segment</code></dt><dd><p>vector of integers that assign observations
to twilight segments.</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Stella and Estelle require a model structure that describes the
model being fitted. These function generate basic model structures
for curve fitting methods that should provide a suitable
starting point for most analyses.</p>
<p>The <code>curveModel</code> function constructs a model structure
assuming that each twilight profile is associated with a single
location.  The errors in observed log light level are assumed to
be Normally distributed about their expected value.</p>
<p>The initialization locations <code>x0</code> and <code>z0</code> must be
consistent with any other constraints imposed by the data.</p>
<p>Both Estelle and Stella variants of the model assume that the
average speed of travel between successive locations is Gamma
distributed, and for Estelle models, the change in bearing
(degrees) along the dog-leg path segments can be assumed Normally
distributed with mean zero.  By default, the speed of travel is
calculated based on the time intervals between the twilights (in
hours), but the intervals of time actually available for travel
can be specified directly with the <code>dt</code> argument.</p>
<p>If <code>beta</code> is a vector, then <code>beta[1]</code> and <code>beta[2]</code>
specify the shape and rate of the Gamma distribution of speeds.
If <code>beta</code> has three elements, then <code>beta[3]</code> specifies
the standard deviation of the change in bearing (in degrees) along
dog leg paths.</p>
<p>The <code>curveModel0</code> function constructs only the non-movement
elements of the model, and can be used as a basis for those
wishing to experiment with alternative movement models.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Simon Wotherspoon, Michael Sumner, Simeon Lisovski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
